<%- include("../partials/admin/header.ejs") %>
    <%- include("../partials/admin/sidebar.ejs") %>

        <div class="container py-2">
            <h2 class="mb-3 fw-bold">Add Product</h2>

            <form action="/admin/products/add-product" method="post" enctype="multipart/form-data"
                onsubmit="return validateForm()">

                <div class="row">
                <div class="mb-2 col-md-6">
                    <label for="productName" class="fw-bold form-label">Product Name</label>
                    <input type="text" name="productName" placeholder="Name.." class="form-control productinput shadow-sm" id="productName"
                        >
                    <div id="nameError" class="text-danger small"></div>
                </div>
                <div class="mb-2 col-md-6">
                    <label for="productDescription" class="form-label fw-bold">Product Descritpion</label>
                    <textarea name="description" id="productDescription" class="form-control productinput shadow-sm"
                        placeholder="Write the description here.."></textarea>
                    <div id="descError" class="text-danger small"></div>
                </div>
                </div>
                <div class="container mb-2">
                    <div class="row">
                        <!-- Brand -->
                        <div class="col-6 col-md-3">
                            <label for="brands" class="form-label fw-bold">Brands</label>
                            <select class="form-select formselect form-select-sm shadow-sm" name="brands" id="brands">
                                <option class="options" value="">Select</option>
                                <% brands.forEach((brand)=>{%>
                                    <option class="options" value="<%= brand._id %>"
                                        style="font-size: 13px; font-weight: semibold;">
                                        <%= brand.brandName %>
                                    </option>
                                    <% }) %>
                            </select>
                            <div id="brandError" class="text-danger small"></div>
                        </div>


                        <!-- Category -->
                        <div class="col-6 col-md-3 mb-2">
                            <label for="category" class="form-label fw-bold">Category</label>
                            <select class="form-select formselect form-select-sm shadow-sm" name="category" id="category">
                                <option class="options" value="">Select</option>
                                <% categorys.forEach((category)=>{%>
                                    
                                    <option class="options" value="<%= category._id %>"
                                        style="font-size: 13px; font-weight: semibold;">
                                        <%= category.name %>
                                    </option>
                                    <% }) %>
                            </select>
                            <div id="categoryError" class="text-danger small"></div>
                        </div>
                        <div class="col-md-2">
                                <label for="color" class="fw-bold mb-2">Color</label>
                                <input type="text" id="color" name="color" class="form-control productinput shadow-sm"
                                    placeholder="Enter color">
                                    <div id="colorerror" class="text-danger small"></div>
                            </div>
                       
                    </div>
                </div>

                <div class="container mb-2">
                    <div class="row">
                        <div class="col-4">
                            <label for="actualPrice" class="form-label fw-bold">Actual Price</label>
                            <input name="actualPrice" type="number" class="form-control productinput shadow-sm" placeholder="₹">
                            <div id="acPriceError" class="text-danger small"></div>
                        </div>
                        <div class="col-4">
                            <label for="discountPrice" class="form-label fw-bold">Discount Price</label>
                            <input name="discountPrice" type="number" class="form-control productinput shadow-sm" placeholder="₹">
                            <div id="dcPriceError" class="text-danger small"></div>
                        </div>
                        <div class="col-4">
                            <label for="quantity" class="form-label fw-bold">Quantity</label>
                            <input name="quantity" type="number" class="form-control productinput shadow-sm">
                            <div id="quantityError" class="text-danger small"></div>
                        </div>
                    </div>
                </div>

                <!-- Edit Photos -->
                <div class="mb-2">
                    <label class="form-label fw-bold">Edit Photos</label>
                    <div class="border p-2 rounded">
                        <div class="row">
                            <% for (let i=1; i <=4; i++) { %>
                                <div
                                    class="col-12 col-md-6 col-lg-3 d-flex flex-column align-items-center mb-3 image-box">
                                    <div class="mb-2 fw-semibold fs-6 text-muted">Add Image <%= i %>
                                    </div>
                                    <div class="image-preview mb-2 text-center rounded text-muted" id="preview<%= i %>"
                                        style="width: 200px; height: 200px; line-height: 200px; border: 2px dashed #6c757d; background-color: #f8f9fa;">
                                        No Image
                                    </div>
                                    <input type="file" name="images" class="form-control productinput crop-image-input"
                                        accept="image/*" style="width: 200px;">
                                    
                                </div>
                                <% } %>
                        </div>
                    </div>
                    <div id="imageError" class="text-danger small"></div>
                </div>


                <div class="container">
                    <div class=" d-flex justify-content-center align-items-center gap-3">
                        <div><a class="btn btn-outline-dark fw-semibold" href="/admin/products">Cancel</a></div>
                        <div><button class="btn btn-dark fw-semibold">Submit</button></div>

                    </div>
                </div>

            </form>
        </div>

        <!-- Modal for cropping -->
        <div class="modal fade" id="cropperModal" tabindex="-1" aria-labelledby="cropperModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" >
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Crop Image</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body mt-3">

                        <img id="cropper-image" />

                    </div>
                    <div class="modal-footer">
                        <button id="cropImageBtn" class="btn btn-dark fw-semibold">Crop & Upload</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        

        <% if (typeof error !=='undefined' && error) { %>
            <script>
            Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: "<%= error %>"
                });
                </script>
                <% } %>
<% if(typeof message !== 'undefined' && message){%>
    <script>
    Swal.fire({
        icon:"error",
        title:"Oops...",
        text:"<%= message %>"
    })
    </script>

    <%}%>
                    <% if (typeof success !=='undefined' && success) { %>
                        <script>
                        Swal.fire({
                        icon: 'success',
                        title: 'Success!',
                        text: "<%= success %>"
                            });
                            </script>
                            <% } %>
                           
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.js"></script>
<script src="/script/admin/addproduct.js"></script>



<%- include("../partials/admin/footer.ejs") %>